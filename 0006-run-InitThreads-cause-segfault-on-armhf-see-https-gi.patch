From 6628bbfa7b647bd9820d2bcc57cfe6f5d7e99a73 Mon Sep 17 00:00:00 2001
From: Kei Okada <k-okada@jsk.t.u-tokyo.ac.jp>
Date: Mon, 28 Feb 2022 20:38:14 +0900
Subject: [PATCH 6/6] run (InitThreads) cause segfault on armhf, see
 https://github.com/euslisp/EusLisp/issues/485#issuecomment-1051010975

---
 lib/eusrt.l | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/lib/eusrt.l b/lib/eusrt.l
index 84155750..5bb85e97 100644
--- a/lib/eusrt.l
+++ b/lib/eusrt.l
@@ -44,6 +44,11 @@
 (in-package "X")
 ;; (shadow 'gc)
 ;; initilize Xlib interface
+
+;; FIXME: run (InitThreads) cause segfault on armhf https://github.com/euslisp/EusLisp/issues/485#issuecomment-1051010975
+#+:(and :arm :word-size=32)
+(delete :x11r6.1 *features*)
+
 (when (and 
        (or (substringp "sx" (pathname-name *program-name*)) (substringp "gl" (pathname-name *program-name*)))
 	(sys::exec-module-init "xforeign" "xwindow/loadx.l")
-- 
2.17.1

